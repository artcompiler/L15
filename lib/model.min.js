var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString),forEach=function(b,c,d){if(Array.prototype.forEach)return b.forEach(c);b=toObject(b);var e=splitString&&"[object String]"==_toString(b)?b.split(""):b,k=-1,a=e.length>>>0;if("[object Function]"!=_toString(c))throw new TypeError;for(;++k<a;)k in e&&c.call(d,e[k],k,b)},filter=function(b,c,d){if(Array.prototype.filter)return b.filter(c);var e=toObject(b);b=splitString&&"[object String]"==_toString(b)?b.split(""):e;var k=
b.length>>>0,a=[],f;if("[object Function]"!=_toString(c))throw new TypeError(c+" is not a function");for(var g=0;g<k;g++)g in b&&(f=b[g],c.call(d,f,g,e)&&a.push(f));return a},every=function(b,c,d){if(Array.prototype.every)return b.every(c,d);var e=toObject(b);b=splitString&&"[object String]"==_toString(b)?b.split(""):e;var k=b.length>>>0;if("[object Function]"!=_toString(c))throw new TypeError(c+" is not a function");for(var a=0;a<k;a++)if(a in b&&!c.call(d,b[a],a,e))return!1;return!0},some=function(b,
c,d){if(Array.prototype.some)return b.some(c,d);var e=toObject(b);b=splitString&&"[object String]"==_toString(b)?b.split(""):e;var k=b.length>>>0;if("[object Function]"!=_toString(c))throw new TypeError(c+" is not a function");for(var a=0;a<k;a++)if(a in b&&c.call(d,b[a],a,e))return!0;return!1},indexOf=function(b,c){var d=arguments[2];if(Array.prototype.indexOf)return b.indexOf(c,d);var e=splitString&&"[object String]"==_toString(b)?b.split(""):toObject(b),k=e.length>>>0;if(!k)return-1;var a=0;2<
arguments.length&&(a=toInteger(d));for(a=0<=a?a:Math.max(0,k+a);a<k;a++)if(a in e&&e[a]===c)return a;return-1},keys=function(b){if(Object.keys)return Object.keys(b);var c=!0,d="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),e=d.length,k;for(k in{toString:null})c=!1;if("object"!=typeof b&&"function"!=typeof b||null===b)throw new TypeError("Object.keys called on a non-object");k=[];for(var a in b)owns(b,a)&&k.push(a);if(c)for(c=0;c<e;c++)a=
d[c],owns(b,a)&&k.push(a);return k},toObject=function(b){if(null==b)throw new TypeError("can't convert "+b+" to object");return Object(b)},prototypeOfObject=Object.prototype,_toString=function(b){return prototypeOfObject.toString.apply(b)},owns=function(b,c){return prototypeOfObject.hasOwnProperty.call(b,c)},create=function(b){if(Object.create)return Object.create(b);var c=function(){};if(1!=arguments.length)throw Error("Object.create implementation only accepts one parameter.");c.prototype=b;return new c};var ASSERT=!0,assert=function(){return ASSERT?function(b,c){void 0===c&&(c="failed!");if(!b){var d=Error(c);d.location=Assert.location;throw d;}}:function(){}}(),message=function(b,c){var d=Assert.messages[b];c&&forEach(c,function(b,c){d=d.replace("%"+(c+1),b)});return b+": "+d},reserveCodeRange=function(b,c,d){assert(b<=c,"Invalid code range");var e=every(Assert.reservedCodes,function(d){return c<d.first||b>d.last});assert(e,"Conflicting request for error code range");Assert.reservedCodes.push({first:b,
last:c,name:d})},setLocation=function(b){Assert.location=b},clearLocation=function(){Assert.location=null},Assert={assert:assert,message:message,messages:{},reserveCodeRange:reserveCodeRange,reservedCodes:[],setLocation:setLocation,clearLocation:clearLocation};var TRACE=!1,global=this,trace=function(){return TRACE?function(b){if(global.console&&global.console.log)console.log(b);else if(global.print)print(b);else throw"No trace function defined!";}:function(){}}();var Ast=function(){function b(){}function c(b){void 0===b&&(b=this);return b.op&&b.args}var d=["unused"],e={};b.clearPool=function(){d=["unused"];e={}};b.prototype.create=function a(b,c){var d=a(this);"string"===typeof b?(d.op=b,d.args=c instanceof Array?c:[]):null!==b&&"object"===typeof b&&forEach(keys(b),function(a,c){d[a]=b[a]});return d};b.prototype.arg=function(b){if(!c(this))throw"Malformed node";this.args.push(b);return this};b.prototype.argN=function(b,f){if(!c(this))throw"Malformed node";
if(void 0===f)return this.args[b];this.args[b]=f;return this};b.prototype.args=function(b){if(!c(this))throw"Malformed node";if(void 0===b)return this.args;this.args=b;return this};b.prototype.isNode=c;b.intern=b.prototype.intern=function f(g){this instanceof b&&void 0===g&&c(this)&&(g=this);"number"===typeof g?g={op:"num",args:[g.toString()]}:"string"===typeof g&&(g={op:"str",args:[g]});assert("object"===typeof g,"node not an object");for(var n=g.op,p=g.args.length,r="",u=[],s=0;s<p;s++)r="str"===
g.op||"num"===g.op||"var"===g.op?r+(u[s]=g.args[s]):r+(u[s]=f(g.args[s]));g=n+p+r;p=e[g];void 0===p&&(d.push({op:n,args:u}),p=d.length-1,e[g]=p);return p};b.prototype.node=function(b){b=JSON.parse(JSON.stringify(d[b]));create(b);switch(b.op){case "num":case "str":case "var":break;default:for(var c=0;c<b.args.length;c++)b.args[c]=this.node(b.args[c])}return b};b.dumpAll=b.prototype.dumpAll=function(){var c="";forEach(d,function(d,e){c+="\n"+e+": "+b.dump(d)});return c};b.dump=b.prototype.dump=function g(b){if("string"===
typeof b)var c='"'+b+'"';else if("number"===typeof b)c=b;else{for(var c='{ op: "'+b.op+'", args: [ ',d=0;d<b.args.length;d++)0<d&&(c+=" , "),c+=g(b.args[d]);c+=" ] }"}return c};return b}();var Model=function(){function b(){}b.fn={};b.env=d={};var c=[],d={};b.pushEnv=function(a){c.push(d);b.env=d=a};b.popEnv=function(){assert(0<c.length,"Empty envStack");b.env=d=c.pop()};var e=b.prototype=new Ast;Assert.reserveCodeRange(1E3,1999,"model");Assert.messages[1001]="Invalid syntax. '%1' expected, '%2' found.";Assert.messages[1002]="Square brackets can only be used to denote intervals.";Assert.messages[1003]="Extra characters in input at position: %1, lexeme: %2.";Assert.messages[1004]="Invalid character '%1' (%2) in input.";
var k=Assert.message;b.create=e.create=function r(a,c){assert(a,"Model.create() called with invalid argument "+a);if(a instanceof b)return c&&(a.location=c),a;if(!(this instanceof b))return(new b).create(a,c);var d=r(this);d.location=c;a="string"===typeof a?n(a,b.env).expr():JSON.parse(JSON.stringify(a));forEach(keys(b.fn),function(a,c){e.hasOwnProperty(a)||(e[a]=function(){var c=b.fn[a];if(1<arguments.length&&arguments[1]instanceof b)return c.apply(this,arguments);for(var d=[this],f=0;f<arguments.length;f++)d.push(arguments[f]);
return c.apply(this,d)})});forEach(keys(a),function(b,c){d[b]=a[b]});return d};b.fromLaTex=e.fromLaTex=function(a){assert("string"===typeof a,"Model.prototype.fromLaTex");return this?this.create(a):b.create(a)};e.toLaTex=function(b){return g(b)};var a={ADD:"+",SUB:"-",MUL:"times",DIV:"div",FRAC:"frac",EQL:"=",ATAN2:"atan2",SQRT:"sqrt",PM:"pm",SIN:"sin",COS:"cos",TAN:"tan",SEC:"sec",COT:"cot",CSC:"csc",LOG:"log",LN:"ln",LG:"lg",VAR:"var",NUM:"num",CST:"cst",COMMA:",",POW:"^",SUBSCRIPT:"_",ABS:"abs",
PAREN:"()",HIGHLIGHT:"hi",LT:"lt",LE:"le",GT:"gt",GE:"ge",INTERVAL:"interval",EXISTS:"exists",IN:"in",FORALL:"forall",LIM:"lim",EXP:"exp",TO:"to",SUM:"sum",INT:"int",PROD:"prod",PERCENT:"%",M:"M",RIGHTARROW:"->"};forEach(keys(a),function(c,d){b[c]=a[c]});var f={};f[a.ADD]="+";f[a.SUB]="-";f[a.MUL]="\\times";f[a.DIV]="\\div";f[a.FRAC]="\\frac";f[a.EQL]="=";f[a.ATAN2]="\\atan2";f[a.POW]="^";f[a.SUBSCRIPT]="_";f[a.PM]="\\pm";f[a.SIN]="\\sin";f[a.COS]="\\cos";f[a.TAN]="\\tan";f[a.SEC]="\\sec";f[a.COT]=
"\\cot";f[a.CSC]="\\csc";f[a.LN]="\\ln";f[a.COMMA]=",";f[a.M]="\\M";var g=function u(b){var c="";if("string"===typeof b)c=b;else if("number"===typeof b)c=b;else if("object"===typeof b){for(var d=[],e=0;e<b.args.length;e++)d[e]=u(b.args[e]);switch(b.op){case a.VAR:case a.CST:case a.NUM:c=b.args[0];break;case a.SUB:c=1===b.args.length?f[b.op]+" "+d[0]:d[0]+" "+f[b.op]+" "+d[1];break;case a.DIV:case a.PM:case a.EQL:c=d[0]+" "+f[b.op]+" "+d[1];break;case a.POW:var e=b.args[0],g=b.args[1];if(e.args&&2===
e.args.length||g.args&&2===g.args.length)if(e.op===a.ADD||e.op===a.SUB||e.op===a.MUL||e.op===a.DIV||e.op===a.SQRT)d[0]=" ("+d[0]+") ";c="{"+d[0]+"^{"+d[1]+"}}";break;case a.SIN:case a.COS:case a.TAN:case a.SEC:case a.COT:case a.CSC:case a.LN:case a.M:c="{"+f[b.op]+"{"+d[0]+"}}";break;case a.FRAC:c="\\dfrac{"+d[0]+"}{"+d[1]+"}";break;case a.SQRT:switch(d.length){case 1:c="\\sqrt{"+d[0]+"}";break;case 2:c="\\sqrt["+d[0]+"]{"+d[1]+"}"}break;case a.MUL:var k,c="";forEach(b.args,function(e,g){if(e.args&&
2<=e.args.length){if(e.op===a.ADD||e.op===a.SUB)d[g]="("+d[g]+")";0!==g&&"number"===typeof e&&(c+=f[b.op]+" ")}else e.op===a.PAREN||e.op===a.VAR||e.op===a.CST||"number"===typeof k&&"number"!==typeof e||0!==g&&(c+=" "+f[b.op]+" ");c+=d[g];k=e});break;case a.ADD:case a.COMMA:forEach(d,function(a,d){c=0===d?a:c+" "+f[b.op]+" "+a});break;default:assert(!1,"unimplemented eval operator")}}else assert(!1,"invalid expression type");return c},n=function(c,d){function e(b,a,c){assert(1<a.length,"Too few argument for binary node");
var d=[];forEach(a,function(a){c&&a.op===b?d=d.concat(a.args):d.push(a)});return{op:b,args:d}}function f(){l=na;na=z;l===z&&(l=q.start())}function g(b){var a=l;a!==b&&(b=String.fromCharCode(b),a=a?String.fromCharCode(a):"EOS",assert(!1,k(1001,[b,a])));f()}function m(){var a,c;switch(c=l){case 65:case 97:case x:a=[q.lexeme()];f();l===y&&(f(),a.push(m()));a={op:"var",args:a};break;case oa:a={op:"num",args:[q.lexeme()]};f();break;case xa:case A:g(c);a=t();g(tk2=l===L?L:B);2===a.args.length||c!==A&&tk2!==
B||assert(!1,k(1002));a.lbrk=c;a.rbrk=tk2;break;case M:a=v();break;case C:f();c=v();a=v();a={op:b.MUL,args:[c,{op:b.POW,args:[a,{op:b.NUM,args:["-1"]}]}]};break;case N:f();switch(l){case A:g(A);c=t();g(B);a=v();a={op:b.POW,args:[a,c,{op:b.NUM,args:["-1"]}]};break;case M:a=v();a={op:b.POW,args:[a,{op:b.NUM,args:["2"]},{op:b.NUM,args:["-1"]}]};break;default:assert(!1,k(1001,["{ or (",String.fromCharCode(l)]))}break;case O:case P:case Q:case R:case S:case T:f();for(a=[];l===D;)f(),a.push(w());a.unshift({op:h[c],
args:[m()]});return 1<a.length?{op:b.POW,args:a}:a[0];case U:return f(),{op:b.LOG,args:[{op:b.VAR,args:["e"]},m()]};case V:return f(),{op:b.LOG,args:[{op:b.NUM,args:["10"]},m()]};case W:return f(),a=[],l===y?(f(),a.push(m())):a.push({op:b.VAR,args:["e"]}),a.push(m()),{op:b.LOG,args:a};case X:return f(),a=[],g(y),a.push(m()),a.push(m()),{op:h[c],args:a};case Y:case Z:case $:return f(),a=[],l===y&&(f(),a.push(m()),g(D),a.push(m())),a.push(t()),{op:h[c],args:a};case aa:return f(),{op:b.EXISTS,args:[ba()]};
case ca:return f(),{op:b.FORALL,args:[t()]};case da:return f(),{op:b.EXP,args:[E()]};case ea:return f(),{op:b.M,args:[E()]};default:assert(!1,"Model.primaryExpr() unexpected expression kind "+q.lexeme()),a=void 0}return a}function v(){g(M);var b=t();g(pa);return b}function w(){var a;switch(l){case fa:f();a=w();break;case F:f();a=w();a={op:b.SUB,args:[a]};break;default:switch(a=m(),l){case qa:f(),a={op:b.PERCENT,args:[a]}}}return a}function n(){for(var a=[w()];l===y;)f(),a.push(w());return 1<a.length?
{op:b.SUBSCRIPT,args:a}:a[0]}function ra(){for(var a=[n()];l===D;)f(),a.push(n());return 1<a.length?{op:b.POW,args:a}:a[0]}function sa(){for(var a,c,d=[ra()];(a=l)&&!ta(a)&&!ua(a)&&a!==G&&a!==ga&&a!==pa&&a!==L&&a!==B&&a!==H;)a!==I&&a!==J||f(),c=ra(),a===J&&(c={op:b.POW,args:[c,{op:b.NUM,args:["-1"]}]}),d.push(c);return 1<d.length?b.env.Au?d[0].op===b.NUM?(a=[d.shift(),e(b.ADD,d)],e(b.MUL,a,void 0)):e(b.ADD,d):{op:b.MUL,args:d}:d[0]}function va(a){if("number"===typeof a)return-a;if(1===a.args.length){if(a.op===
b.SUB)return a.args[0];if(a.op===b.ADD)return a.args[0]=va(a.args[0]),a}else if(a.op===b.MUL)return a.args.unshift({op:b.NUM,args:["-1"]}),a;return{op:b.MUL,args:[{op:b.NUM,args:["-1"]},a]}}function ta(a){return a===fa||a===F||a===K}function E(){for(var a=sa(),c;ta(c=l);){f();var d=sa();switch(c){case K:a={op:b.PM,args:[a,d]};break;case F:d=va(d);default:a={op:b.ADD,args:[a,d]}}}return a}function ua(a){return a===ha||a===ia||a===ja||a===ka||a===la||a===ma}function wa(){for(var a=E(),b;ua(b=l);){f();
var c=E();switch(b){default:a={op:h[b],args:[a,c]}}}return a}function ba(){for(var a=wa(),b;(b=l)===ga||b===H;){f();var c=wa(),a={op:h[b],args:[a,c]}}return a}function t(){for(var a=ba(),b=[a];l===G;)f(),b.push(ba());return 1<b.length?{op:h[G],args:b}:a}var z=0,fa=43,D=94,y=95,P=261,S=264,T=265,J=47,ga=61,C=256,U=263,M=123,A=91,xa=40,I=42,oa=48,K=258,pa=125,B=93,L=41,R=262,O=259,N=257,F=45,Q=260,x=97,G=44,V=267,W=268,ha=270,ia=271,ja=272,ka=273,aa=274,la=275,ca=276,X=277,da=278,ma=279,Y=280,Z=281,
$=282,qa=37,ea=283,H=284,h=[],l=z,na=z;h[C]=a.FRAC;h[N]=a.SQRT;h[fa]=a.ADD;h[F]=a.SUB;h[K]=a.PM;h[D]=a.POW;h[I]=a.MUL;h[J]=a.FRAC;h[O]=a.SIN;h[P]=a.COS;h[Q]=a.TAN;h[R]=a.SEC;h[S]=a.COT;h[T]=a.CSC;h[U]=a.LN;h[V]=a.LG;h[W]=a.LOG;h[ga]=a.EQL;h[G]=a.COMMA;h[269]=a.TEXT;h[ha]=a.LT;h[ia]=a.LE;h[ja]=a.GT;h[ka]=a.GE;h[aa]=a.EXISTS;h[la]=a.IN;h[ca]=a.FORALL;h[X]=a.LIM;h[da]=a.EXP;h[ma]=a.TO;h[Y]=a.SUM;h[Z]=a.INT;h[$]=a.PROD;h[ea]=a.M;h[H]=a.RIGHTARROW;var q=function(a){function b(e){var d=String.fromCharCode(e);
for(f+=d;97<=e&&122>=e||65<=e&&90>=e;){e=a.charCodeAt(c++);var d=String.fromCharCode(e),h=f+d;if(!some(g,function(a){return 0===a.indexOf(h)}))break;f+=d}c--;return x}var c=0,f="",e=[];e["\\cdot"]=I;e["\\times"]=I;e["\\div"]=J;e["\\dfrac"]=C;e["\\frac"]=C;e["\\sqrt"]=N;e["\\pm"]=K;e["\\sin"]=O;e["\\cos"]=P;e["\\tan"]=Q;e["\\sec"]=R;e["\\cot"]=S;e["\\csc"]=T;e["\\ln"]=U;e["\\lg"]=V;e["\\log"]=W;e["\\left"]=null;e["\\right"]=null;e["\\big"]=null;e["\\Big"]=null;e["\\bigg"]=null;e["\\Bigg"]=null;e["\\text"]=
269;e["\\textrm"]=269;e["\\textit"]=269;e["\\textbf"]=269;e["\\lt"]=ha;e["\\le"]=ia;e["\\gt"]=ja;e["\\ge"]=ka;e["\\exists"]=aa;e["\\in"]=la;e["\\forall"]=ca;e["\\lim"]=X;e["\\exp"]=da;e["\\to"]=ma;e["\\sum"]=Y;e["\\int"]=Z;e["\\prod"]=$;e["\\%"]=qa;e["\\M"]=ea;e["\\rightarrow"]=H;var g=keys(d);return{start:function(){var d;for(f="";c<a.length;)switch(d=a.charCodeAt(c++)){case 32:case 9:case 10:case 13:continue;case 92:f+=String.fromCharCode(d);d=a.charCodeAt(c++);if(36===d)f=String.fromCharCode(d);
else if(37===d)f+=String.fromCharCode(d);else{for(;97<=d&&122>=d||65<=d&&90>=d;)f+=String.fromCharCode(d),d=a.charCodeAt(c++);c--}d=e[f];if(void 0===d)d=x;else if(269===d){for(d=a.charCodeAt(c++);123!==d;)d=a.charCodeAt(c++);f="";for(d=a.charCodeAt(c++);125!==d;)d=String.fromCharCode(d),f+=d,d=a.charCodeAt(c++);d=x}if(d)return d;f="";continue;case 37:case 40:case 41:case 42:case 43:case 44:case 45:case 47:case 61:case 91:case 93:case 94:case 95:case 123:case 125:return f+=String.fromCharCode(d),d;
case 36:return f+=String.fromCharCode(d),x;default:if(65<=d&&90>=d||97<=d&&122>=d)return b(d);if(46===d||48<=d&&57>=d){for(;48<=d&&57>=d||46===d;)f+=String.fromCharCode(d),d=a.charCodeAt(c++);c--;return oa}assert(!1,k(1004,[String.fromCharCode(d),d]));return 0}return 0},lexeme:function(){return f},pos:function(){return c}}}(c);return{expr:function(){l=q.start();var a=t();assert(!l,k(1003,[q.pos(),q.lexeme()]));return a}}};return b}();
