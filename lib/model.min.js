var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString),forEach=function(a,c,f){if(Array.prototype.forEach)return a.forEach(c);a=toObject(a);var d=splitString&&"[object String]"==_toString(a)?a.split(""):a,k=-1,b=d.length>>>0;if("[object Function]"!=_toString(c))throw new TypeError;for(;++k<b;)k in d&&c.call(f,d[k],k,a)},filter=function(a,c,f){if(Array.prototype.filter)return a.filter(c);var d=toObject(a);a=splitString&&"[object String]"==_toString(a)?a.split(""):d;var k=
a.length>>>0,b=[],g;if("[object Function]"!=_toString(c))throw new TypeError(c+" is not a function");for(var e=0;e<k;e++)e in a&&(g=a[e],c.call(f,g,e,d)&&b.push(g));return b},every=function(a,c,f){if(Array.prototype.every)return a.every(c,f);var d=toObject(a);a=splitString&&"[object String]"==_toString(a)?a.split(""):d;var k=a.length>>>0;if("[object Function]"!=_toString(c))throw new TypeError(c+" is not a function");for(var b=0;b<k;b++)if(b in a&&!c.call(f,a[b],b,d))return!1;return!0},some=function(a,
c,f){if(Array.prototype.some)return a.some(c,f);var d=toObject(a);a=splitString&&"[object String]"==_toString(a)?a.split(""):d;var k=a.length>>>0;if("[object Function]"!=_toString(c))throw new TypeError(c+" is not a function");for(var b=0;b<k;b++)if(b in a&&c.call(f,a[b],b,d))return!0;return!1},indexOf=function(a,c){var f=arguments[2];if(Array.prototype.indexOf)return a.indexOf(c,f);var d=splitString&&"[object String]"==_toString(a)?a.split(""):toObject(a),k=d.length>>>0;if(!k)return-1;var b=0;2<
arguments.length&&(b=toInteger(f));for(b=0<=b?b:Math.max(0,k+b);b<k;b++)if(b in d&&d[b]===c)return b;return-1},keys=function(a){if(Object.keys)return Object.keys(a);var c=!0,f="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),d=f.length,k;for(k in{toString:null})c=!1;if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError("Object.keys called on a non-object");k=[];for(var b in a)owns(a,b)&&k.push(b);if(c)for(c=0;c<d;c++)b=
f[c],owns(a,b)&&k.push(b);return k},toObject=function(a){if(null==a)throw new TypeError("can't convert "+a+" to object");return Object(a)},prototypeOfObject=Object.prototype,_toString=function(a){return prototypeOfObject.toString.apply(a)},owns=function(a,c){return prototypeOfObject.hasOwnProperty.call(a,c)},create=function(a){if(Object.create)return Object.create(a);var c=function(){};if(1!=arguments.length)throw Error("Object.create implementation only accepts one parameter.");c.prototype=a;return new c};var ASSERT=!0,assert=function(){return ASSERT?function(a,c){void 0===c&&(c="failed!");if(!a){var f=Error(c);f.location=Assert.location;throw f;}}:function(){}}(),message=function(a,c){var f=Assert.messages[a];c&&forEach(c,function(a,c){f=f.replace("%"+(c+1),a)});return a+": "+f},reserveCodeRange=function(a,c,f){assert(a<=c,"Invalid code range");var d=every(Assert.reservedCodes,function(f){return c<f.first||a>f.last});assert(d,"Conflicting request for error code range");Assert.reservedCodes.push({first:a,
last:c,name:f})},setLocation=function(a){Assert.location=a},clearLocation=function(){Assert.location=null},Assert={assert:assert,message:message,messages:{},reserveCodeRange:reserveCodeRange,reservedCodes:[],setLocation:setLocation,clearLocation:clearLocation};var TRACE=!1,global=this,trace=function(){return TRACE?function(a){if(global.console&&global.console.log)console.log(a);else if(global.print)print(a);else throw"No trace function defined!";}:function(){}}();var Ast=function(){function a(){}function c(a){void 0===a&&(a=this);return a.op&&a.args}var f=["unused"],d={};a.clearPool=function(){f=["unused"];d={}};a.prototype.create=function b(a,c){var f=b(this);"string"===typeof a?(f.op=a,f.args=c instanceof Array?c:[]):null!==a&&"object"===typeof a&&forEach(keys(a),function(b,c){f[b]=a[b]});return f};a.prototype.arg=function(a){if(!c(this))throw"Malformed node";this.args.push(a);return this};a.prototype.argN=function(a,g){if(!c(this))throw"Malformed node";
if(void 0===g)return this.args[a];this.args[a]=g;return this};a.prototype.args=function(a){if(!c(this))throw"Malformed node";if(void 0===a)return this.args;this.args=a;return this};a.prototype.isNode=c;a.intern=a.prototype.intern=function g(e){this instanceof a&&void 0===e&&c(this)&&(e=this);"number"===typeof e?e={op:"num",args:[e.toString()]}:"string"===typeof e&&(e={op:"str",args:[e]});assert("object"===typeof e,"node not an object");for(var m=e.op,n=e.args.length,q="",t=[],r=0;r<n;r++)q="str"===
e.op||"num"===e.op||"var"===e.op?q+(t[r]=e.args[r]):q+(t[r]=g(e.args[r]));e=m+n+q;n=d[e];void 0===n&&(f.push({op:m,args:t}),n=f.length-1,d[e]=n);return n};a.prototype.node=function(a){a=JSON.parse(JSON.stringify(f[a]));create(a);switch(a.op){case "num":case "str":case "var":break;default:for(var c=0;c<a.args.length;c++)a.args[c]=this.node(a.args[c])}return a};a.dumpAll=a.prototype.dumpAll=function(){var c="";forEach(f,function(f,d){c+="\n"+d+": "+a.dump(f)});return c};a.dump=a.prototype.dump=function e(a){if("string"===
typeof a)var c='"'+a+'"';else if("number"===typeof a)c=a;else{for(var c='{ op: "'+a.op+'", args: [ ',f=0;f<a.args.length;f++)0<f&&(c+=" , "),c+=e(a.args[f]);c+=" ] }"}return c};return a}();var Model=function(){function a(){}a.fn={};a.env=f={};var c=[],f={};a.pushEnv=function(b){c.push(f);a.env=f=b};a.popEnv=function(){assert(0<c.length,"Empty envStack");a.env=f=c.pop()};var d=a.prototype=new Ast;Assert.reserveCodeRange(1E3,1999,"model");Assert.messages[1001]="Invalid syntax. '%1' expected, '%2' found.";Assert.messages[1002]="Square brackets can only be used to denote intervals.";Assert.messages[1003]="Extra characters in input at position: %1, lexeme: %2.";Assert.messages[1004]="Invalid character '%1' (%2) in input.";
var k=Assert.message;a.create=d.create=function q(b,c){assert(b,"Model.create() called with invalid argument "+b);if(b instanceof a)return c&&(b.location=c),b;if(!(this instanceof a))return(new a).create(b,c);var f=q(this);f.location=c;b="string"===typeof b?m(b,a.env).expr():JSON.parse(JSON.stringify(b));forEach(keys(a.fn),function(b,c){d.hasOwnProperty(b)||(d[b]=function(){var c=a.fn[b];if(1<arguments.length&&arguments[1]instanceof a)return c.apply(this,arguments);for(var f=[this],g=0;g<arguments.length;g++)f.push(arguments[g]);
return c.apply(this,f)})});forEach(keys(b),function(a,c){f[a]=b[a]});return f};a.fromLaTex=d.fromLaTex=function(b){assert("string"===typeof b,"Model.prototype.fromLaTex");return this?this.create(b):a.create(b)};d.toLaTex=function(a){return e(a)};var b={ADD:"+",SUB:"-",MUL:"times",DIV:"div",FRAC:"frac",EQL:"=",ATAN2:"atan2",SQRT:"sqrt",PM:"pm",SIN:"sin",COS:"cos",TAN:"tan",SEC:"sec",COT:"cot",CSC:"csc",LOG:"log",LN:"ln",LG:"lg",VAR:"var",NUM:"num",CST:"cst",COMMA:",",POW:"^",SUBSCRIPT:"_",ABS:"abs",
PAREN:"()",HIGHLIGHT:"hi",LT:"lt",LE:"le",GT:"gt",GE:"ge",INTERVAL:"interval",EXISTS:"exists",IN:"in",FORALL:"forall",LIM:"lim",EXP:"exp",TO:"to",SUM:"sum",INT:"int",PROD:"prod",PERCENT:"%",M:"M"};forEach(keys(b),function(c,f){a[c]=b[c]});var g={};g[b.ADD]="+";g[b.SUB]="-";g[b.MUL]="\\times";g[b.DIV]="\\div";g[b.FRAC]="\\frac";g[b.EQL]="=";g[b.ATAN2]="\\atan2";g[b.POW]="^";g[b.SUBSCRIPT]="_";g[b.PM]="\\pm";g[b.SIN]="\\sin";g[b.COS]="\\cos";g[b.TAN]="\\tan";g[b.SEC]="\\sec";g[b.COT]="\\cot";g[b.CSC]=
"\\csc";g[b.LN]="\\ln";g[b.COMMA]=",";g[b.M]="\\M";var e=function t(a){var c="";if("string"===typeof a)c=a;else if("number"===typeof a)c=a;else if("object"===typeof a){for(var f=[],d=0;d<a.args.length;d++)f[d]=t(a.args[d]);switch(a.op){case b.VAR:case b.CST:case b.NUM:c=a.args[0];break;case b.SUB:c=1===a.args.length?g[a.op]+" "+f[0]:f[0]+" "+g[a.op]+" "+f[1];break;case b.DIV:case b.PM:case b.EQL:c=f[0]+" "+g[a.op]+" "+f[1];break;case b.POW:var d=a.args[0],e=a.args[1];if(d.args&&2===d.args.length||
e.args&&2===e.args.length)if(d.op===b.ADD||d.op===b.SUB||d.op===b.MUL||d.op===b.DIV||d.op===b.SQRT)f[0]=" ("+f[0]+") ";c="{"+f[0]+"^{"+f[1]+"}}";break;case b.SIN:case b.COS:case b.TAN:case b.SEC:case b.COT:case b.CSC:case b.LN:case b.M:c="{"+g[a.op]+"{"+f[0]+"}}";break;case b.FRAC:c="\\dfrac{"+f[0]+"}{"+f[1]+"}";break;case b.SQRT:switch(f.length){case 1:c="\\sqrt{"+f[0]+"}";break;case 2:c="\\sqrt["+f[0]+"]{"+f[1]+"}"}break;case b.MUL:var k,c="";forEach(a.args,function(d,e){if(d.args&&2<=d.args.length){if(d.op===
b.ADD||d.op===b.SUB)f[e]="("+f[e]+")";0!==e&&"number"===typeof d&&(c+=g[a.op]+" ")}else d.op===b.PAREN||d.op===b.VAR||d.op===b.CST||"number"===typeof k&&"number"!==typeof d||0!==e&&(c+=" "+g[a.op]+" ");c+=f[e];k=d});break;case b.ADD:case b.COMMA:forEach(f,function(b,f){c=0===f?b:c+" "+g[a.op]+" "+b});break;default:assert(!1,"unimplemented eval operator")}}else assert(!1,"invalid expression type");return c},m=function(b,c){function f(a,b,c){assert(1<b.length,"Too few argument for binary node");var d=
[];forEach(b,function(b){c&&b.op===a?d=d.concat(b.args):d.push(b)});return{op:a,args:d}}function d(){l=la;la=y;l===y&&(l=p.start())}function g(a){var b=l;b!==a&&(a=String.fromCharCode(a),b=b?String.fromCharCode(b):"EOS",assert(!1,k(1001,[a,b])));d()}function e(){var b,c;switch(c=l){case 65:case 97:case w:b=[p.lexeme()];d();l===x&&(d(),b.push(e()));b={op:"var",args:b};break;case ma:b={op:"num",args:[p.lexeme()]};d();break;case va:case z:g(c);b=s();g(tk2=l===J?J:A);2===b.args.length||c!==z&&tk2!==A||
assert(!1,k(1002));b.lbrk=c;b.rbrk=tk2;break;case K:b=u();break;case B:d();c=u();b=u();b={op:a.MUL,args:[c,{op:a.POW,args:[b,{op:a.NUM,args:["-1"]}]}]};break;case L:d();switch(l){case z:g(z);c=s();g(A);b=u();b={op:a.POW,args:[b,c,{op:a.NUM,args:["-1"]}]};break;case K:b=u();b={op:a.POW,args:[b,{op:a.NUM,args:["2"]},{op:a.NUM,args:["-1"]}]};break;default:assert(!1,k(1001,["{ or (",String.fromCharCode(l)]))}break;case M:case N:case O:case P:case Q:case R:d();for(b=[];l===C;)d(),b.push(v());b.unshift({op:h[c],
args:[e()]});return 1<b.length?{op:a.POW,args:b}:b[0];case S:return d(),{op:a.LOG,args:[{op:a.VAR,args:["e"]},e()]};case T:return d(),{op:a.LOG,args:[{op:a.NUM,args:["10"]},e()]};case U:return d(),b=[],l===x?(d(),b.push(e())):b.push({op:a.VAR,args:["e"]}),b.push(e()),{op:a.LOG,args:b};case V:return d(),b=[],g(x),b.push(e()),b.push(e()),{op:h[c],args:b};case W:case X:case Y:return d(),b=[],l===x&&(d(),b.push(e()),g(C),b.push(e())),b.push(s()),{op:h[c],args:b};case Z:return d(),{op:a.EXISTS,args:[$()]};
case aa:return d(),{op:a.FORALL,args:[s()]};case ba:return d(),{op:a.EXP,args:[D()]};case ca:return d(),{op:a.M,args:[D()]};default:assert(!1,"Model.primaryExpr() unexpected expression kind "+p.lexeme()),b=void 0}return b}function u(){g(K);var a=s();g(na);return a}function v(){var b;switch(l){case da:d();b=v();break;case E:d();b=v();b={op:a.SUB,args:[b]};break;default:switch(b=e(),l){case oa:d(),b={op:a.PERCENT,args:[b]}}}return b}function m(){for(var b=[v()];l===x;)d(),b.push(v());return 1<b.length?
{op:a.SUBSCRIPT,args:b}:b[0]}function pa(){for(var b=[m()];l===C;)d(),b.push(m());return 1<b.length?{op:a.POW,args:b}:b[0]}function qa(){for(var b,c,e=[pa()];(b=l)&&!ra(b)&&!sa(b)&&b!==F&&b!==ea&&b!==na&&b!==J&&b!==A;)b!==G&&b!==H||d(),c=pa(),b===H&&(c={op:a.POW,args:[c,{op:a.NUM,args:["-1"]}]}),e.push(c);return 1<e.length?a.env.Au?e[0].op===a.NUM?(b=[e.shift(),f(a.ADD,e)],f(a.MUL,b,void 0)):f(a.ADD,e):{op:a.MUL,args:e}:e[0]}function ta(b){if("number"===typeof b)return-b;if(1===b.args.length){if(b.op===
a.SUB)return b.args[0];if(b.op===a.ADD)return b.args[0]=ta(b.args[0]),b}else if(b.op===a.MUL)return b.args.unshift({op:a.NUM,args:["-1"]}),b;return{op:a.MUL,args:[{op:a.NUM,args:["-1"]},b]}}function ra(a){return a===da||a===E||a===I}function D(){for(var b=qa(),c;ra(c=l);){d();var f=qa();switch(c){case I:b={op:a.PM,args:[b,f]};break;case E:f=ta(f);default:b={op:a.ADD,args:[b,f]}}}return b}function sa(a){return a===fa||a===ga||a===ha||a===ia||a===ja||a===ka}function ua(){for(var a=D(),b;sa(b=l);){d();
var c=D();switch(b){default:a={op:h[b],args:[a,c]}}}return a}function $(){for(var a=ua(),b;(b=l)===ea;){d();var c=ua(),a={op:h[b],args:[a,c]}}return a}function s(){for(var a=$(),b=[a];l===F;)d(),b.push($());return 1<b.length?{op:h[F],args:b}:a}var y=0,da=43,C=94,x=95,N=261,Q=264,R=265,H=47,ea=61,B=256,S=263,K=123,z=91,va=40,G=42,ma=48,I=258,na=125,A=93,J=41,P=262,M=259,L=257,E=45,O=260,w=97,F=44,T=267,U=268,fa=270,ga=271,ha=272,ia=273,Z=274,ja=275,aa=276,V=277,ba=278,ka=279,W=280,X=281,Y=282,oa=37,
ca=283,h=[],l=y,la=y;h[B]="frac";h[L]="sqrt";h[da]="+";h[E]="-";h[I]="pm";h[C]="^";h[G]="times";h[H]="frac";h[M]="sin";h[N]="cos";h[O]="tan";h[P]="sec";h[Q]="cot";h[R]="csc";h[S]="ln";h[T]="lg";h[U]="log";h[ea]="=";h[F]=",";h[269]="text";h[fa]="lt";h[ga]="le";h[ha]="gt";h[ia]="ge";h[Z]="exists";h[ja]="in";h[aa]="forall";h[V]="lim";h[ba]="exp";h[ka]="to";h[W]="sum";h[X]="int";h[Y]="prod";h[ca]="M";var p=function(a){function b(c){var e=String.fromCharCode(c);for(d+=e;97<=c&&122>=c||65<=c&&90>=c;){c=
a.charCodeAt(f++);var e=String.fromCharCode(c),h=d+e;if(!some(g,function(a){return 0===a.indexOf(h)}))break;d+=e}f--;return w}var f=0,d="",e=[];e["\\cdot"]=G;e["\\times"]=G;e["\\div"]=H;e["\\dfrac"]=B;e["\\frac"]=B;e["\\sqrt"]=L;e["\\pm"]=I;e["\\sin"]=M;e["\\cos"]=N;e["\\tan"]=O;e["\\sec"]=P;e["\\cot"]=Q;e["\\csc"]=R;e["\\ln"]=S;e["\\lg"]=T;e["\\log"]=U;e["\\left"]=null;e["\\right"]=null;e["\\big"]=null;e["\\Big"]=null;e["\\bigg"]=null;e["\\Bigg"]=null;e["\\text"]=269;e["\\textrm"]=269;e["\\textit"]=
269;e["\\textbf"]=269;e["\\lt"]=fa;e["\\le"]=ga;e["\\gt"]=ha;e["\\ge"]=ia;e["\\exists"]=Z;e["\\in"]=ja;e["\\forall"]=aa;e["\\lim"]=V;e["\\exp"]=ba;e["\\to"]=ka;e["\\sum"]=W;e["\\int"]=X;e["\\prod"]=Y;e["\\%"]=oa;e["\\M"]=ca;var g=keys(c);return{start:function(){var c;for(d="";f<a.length;)switch(c=a.charCodeAt(f++)){case 32:case 9:case 10:case 13:continue;case 92:d+=String.fromCharCode(c);c=a.charCodeAt(f++);if(36===c)d=String.fromCharCode(c);else if(37===c)d+=String.fromCharCode(c);else{for(;97<=
c&&122>=c||65<=c&&90>=c;)d+=String.fromCharCode(c),c=a.charCodeAt(f++);f--}c=e[d];if(void 0===c)c=w;else if(269===c){for(c=a.charCodeAt(f++);123!==c;)c=a.charCodeAt(f++);d="";for(c=a.charCodeAt(f++);125!==c;)c=String.fromCharCode(c),d+=c,c=a.charCodeAt(f++);c=w}if(c)return c;d="";continue;case 37:case 40:case 41:case 42:case 43:case 44:case 45:case 47:case 61:case 91:case 93:case 94:case 95:case 123:case 125:return d+=String.fromCharCode(c),c;case 36:return d+=String.fromCharCode(c),w;default:if(65<=
c&&90>=c||97<=c&&122>=c)return b(c);if(46===c||48<=c&&57>=c){for(;48<=c&&57>=c||46===c;)d+=String.fromCharCode(c),c=a.charCodeAt(f++);f--;return ma}assert(!1,k(1004,[String.fromCharCode(c),c]));return 0}return 0},lexeme:function(){return d},pos:function(){return f}}}(b);return{expr:function(){l=p.start();var a=s();assert(!l,k(1003,[p.pos(),p.lexeme()]));return a}}};return a}();
